<!-- Header -->
<header id="site-header" class="relative z-50 bg-transparent backdrop-blur border-b border-slate-300" x-data="{ mobileMenuOpen: false }">
  <div class="w-full mx-auto max-w-6xl px-5 sm:px-6">
    <div class="flex items-center justify-between gap-4 py-5">
      <!-- Logo -->
      <a href="/" class="group inline-flex items-center gap-3">
        <div class="leading-tight">
          <div class="text-md font-semibold tracking-tight text-slate-900 group-hover:text-emerald-950">{{ brand:site_name }}</div>
          <div class="text-sm text-slate-600">{{ brand:site_subtitle }}</div>
        </div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex gap-6 text-sm text-slate-700">
        {{ nav:main_nav }}
          <a href="{{ url }}" class="{{ is_current || is_parent ? 'font-semibold text-slate-900' : 'hover:text-slate-900' }}">
            {{ title }}
          </a>
        {{ /nav:main_nav }}
      </nav>

      <!-- CTA Button & Mobile Menu Toggle -->
      <div class="flex items-center gap-3">
        {{ unless segment_1 == 'contact' }}
          <a href="/contact"
             class="hidden sm:inline-flex items-center justify-center rounded-xl bg-emerald-900 px-4 py-2.5 text-sm font-semibold text-white shadow-sm shadow-emerald-950/10 hover:bg-emerald-950">
            Start a Conversation
          </a>
        {{ /unless }}

        <!-- Mobile Menu Button -->
        <button
          @click="mobileMenuOpen = !mobileMenuOpen"
          class="inline-flex md:hidden items-center justify-center rounded-xl border border-slate-200/70 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50"
          aria-label="Toggle menu"
          aria-expanded="false"
          x-bind:aria-expanded="mobileMenuOpen.toString()">
          <svg x-show="!mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg x-show="mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" x-cloak>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Navigation Overlay -->
  <div
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click="mobileMenuOpen = false"
    class="fixed inset-0 z-[9998] bg-slate-900/50 md:hidden"
    x-cloak>
  </div>

  <!-- Mobile Navigation Panel -->
  <div
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="translate-x-full"
    class="fixed inset-y-0 right-0 z-[9999] h-screen w-full max-w-sm bg-white shadow-2xl md:hidden"
    x-cloak>
    <div class="grid h-full grid-rows-[auto_1fr_auto]">
      <!-- Mobile Menu Header -->
      <div class="flex items-center justify-between border-b border-slate-200 px-5 py-5">
        <span class="text-lg font-semibold text-slate-900">Menu</span>
        <button
          @click="mobileMenuOpen = false"
          class="rounded-lg p-2 text-slate-500 hover:bg-slate-100"
          aria-label="Close menu">
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Mobile Menu Links -->
      <nav class="flex-1 min-h-0 overflow-y-auto px-5 py-6">
        <div class="space-y-1">
          {{ nav:main_nav }}
            <a
              href="{{ url }}"
              @click="mobileMenuOpen = false"
              class="block rounded-lg px-4 py-3 text-base font-medium {{ is_current || is_parent ? 'bg-emerald-50 text-emerald-900' : 'text-slate-700 hover:bg-slate-50' }}">
              {{ title }}
            </a>
          {{ /nav:main_nav }}
        </div>
      </nav>

      <!-- Mobile Menu Footer -->
      <div class="border-t border-slate-200 px-5 py-6">
        {{ unless segment_1 == 'contact' }}
          <a
            href="/contact"
            @click="mobileMenuOpen = false"
            class="block w-full rounded-xl bg-emerald-900 px-4 py-3 text-center text-sm font-semibold text-white hover:bg-emerald-950">
            Start a Conversation
          </a>
        {{ /unless }}
      </div>
    </div>
  </div>
</header>
